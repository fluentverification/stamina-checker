\hypertarget{StaminaArgParse_8h_source}{}\doxysection{Stamina\+Arg\+Parse.\+h}
\label{StaminaArgParse_8h_source}\index{/home/josh/Documents/Work/stamina-\/cplusplus/src/stamina/StaminaArgParse.h@{/home/josh/Documents/Work/stamina-\/cplusplus/src/stamina/StaminaArgParse.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#ifndef STAMINA\_STAMINAARGPARSE\_H}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#define STAMINA\_STAMINAARGPARSE\_H}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <argp.h>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{keyword}{enum} STAMINA\_METHODS \{}
\DoxyCodeLine{16     ITERATIVE\_METHOD = 0          \textcolor{comment}{// STAMINA 2.5}}
\DoxyCodeLine{17     , PRIORITY\_METHOD = 1         \textcolor{comment}{// STAMINA 3.0}}
\DoxyCodeLine{18     , RE\_EXPLORING\_METHOD = 2     \textcolor{comment}{// STAMINA 2.0}}
\DoxyCodeLine{19 \};}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keyword}{static} \textcolor{keywordtype}{char} doc[] = \textcolor{stringliteral}{"{}STAMINA -\/-\/ truncates infinite CTMC state space and passes into STORM"{}};}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{static} \textcolor{keywordtype}{char} args\_doc[] = \textcolor{stringliteral}{"{}MODEL\_FILE PROPERTIES\_FILE"{}};}
\DoxyCodeLine{26 }
\DoxyCodeLine{30 \textcolor{keyword}{static} \textcolor{keyword}{struct }argp\_option options[] = \{}
\DoxyCodeLine{31     \{\textcolor{stringliteral}{"{}kappa"{}}, \textcolor{charliteral}{'k'}, \textcolor{stringliteral}{"{}double"{}}, 0,}
\DoxyCodeLine{32         \textcolor{stringliteral}{"{}Reachability threshold for the first iteration (default: 1.0)"{}}\}}
\DoxyCodeLine{33     , \{\textcolor{stringliteral}{"{}reduceKappa"{}}, \textcolor{charliteral}{'r'}, \textcolor{stringliteral}{"{}double"{}}, 0,}
\DoxyCodeLine{34         \textcolor{stringliteral}{"{}Reduction factor for Reachability Threshold (kappa) during the refinement step (default 2.0)"{}}\}}
\DoxyCodeLine{35     , \{\textcolor{stringliteral}{"{}approxFactor"{}}, \textcolor{charliteral}{'f'}, \textcolor{stringliteral}{"{}double"{}}, 0,}
\DoxyCodeLine{36         \textcolor{stringliteral}{"{}Factor to estimate how far off our reachability predictions will be (default: 2.0)"{}}\}}
\DoxyCodeLine{37     , \{\textcolor{stringliteral}{"{}probWin"{}}, \textcolor{charliteral}{'w'}, \textcolor{stringliteral}{"{}double"{}}, 0,}
\DoxyCodeLine{38         \textcolor{stringliteral}{"{}Probability window between lower and upperbound for termination (default: 1.0e-\/3)"{}}\}}
\DoxyCodeLine{39     , \{\textcolor{stringliteral}{"{}maxApproxCount"{}}, \textcolor{charliteral}{'n'}, \textcolor{stringliteral}{"{}int"{}}, 0,}
\DoxyCodeLine{40         \textcolor{stringliteral}{"{}Maximum number of iterations in the approximation (default 10)"{}}\}}
\DoxyCodeLine{41     , \{\textcolor{stringliteral}{"{}noPropRefine"{}}, \textcolor{charliteral}{'R'}, 0, 0,}
\DoxyCodeLine{42         \textcolor{stringliteral}{"{}Do not use property based refinement. If given, the model exploration method will reduce kappa and do property independent definement (default: off)"{}}\}}
\DoxyCodeLine{43     , \{\textcolor{stringliteral}{"{}cuddMaxMem"{}}, \textcolor{charliteral}{'C'}, \textcolor{stringliteral}{"{}memory"{}}, 0,}
\DoxyCodeLine{44         \textcolor{stringliteral}{"{}Maximum CUDD memory, in the same format as PRISM (default: 1g)"{}}\}}
\DoxyCodeLine{45     , \{\textcolor{stringliteral}{"{}export"{}}, \textcolor{charliteral}{'e'}, \textcolor{stringliteral}{"{}filename"{}}, 0,}
\DoxyCodeLine{46         \textcolor{stringliteral}{"{}Export model to a (text) file"{}}\}}
\DoxyCodeLine{47     , \{\textcolor{stringliteral}{"{}exportPerimeterStates"{}}, \textcolor{charliteral}{'S'}, \textcolor{stringliteral}{"{}filename"{}}, 0,}
\DoxyCodeLine{48         \textcolor{stringliteral}{"{}Export perimeter states to a file. Please provide a filename. This will append to the file if it is existing"{}}\}}
\DoxyCodeLine{49     , \{\textcolor{stringliteral}{"{}import"{}}, \textcolor{charliteral}{'i'}, \textcolor{stringliteral}{"{}filename"{}}, 0,}
\DoxyCodeLine{50         \textcolor{stringliteral}{"{}Import model to a (text) file"{}}\}}
\DoxyCodeLine{51     , \{\textcolor{stringliteral}{"{}property"{}}, \textcolor{charliteral}{'p'}, \textcolor{stringliteral}{"{}propname"{}}, 0,}
\DoxyCodeLine{52         \textcolor{stringliteral}{"{}Specify a certain property to check in a model file that contains many"{}}\}}
\DoxyCodeLine{53     , \{\textcolor{stringliteral}{"{}const"{}}, \textcolor{charliteral}{'c'}, \textcolor{stringliteral}{"{}\(\backslash\)"{}C1=VAL,C2=VAL,C3=VAL\(\backslash\)"{}"{}}, 0,}
\DoxyCodeLine{54         \textcolor{stringliteral}{"{}Comma separated values for constants"{}}\}}
\DoxyCodeLine{55     , \{\textcolor{stringliteral}{"{}exportTrans"{}}, \textcolor{charliteral}{'t'}, \textcolor{stringliteral}{"{}filename"{}}, 0,}
\DoxyCodeLine{56         \textcolor{stringliteral}{"{}Export the list of transitions and actions to a specified file name, or to trans.txt if no file name is specified.\(\backslash\)nTransitions are exported in the format <Source State Index> <Destination State Index> <Action Label>"{}}\}}
\DoxyCodeLine{57     \textcolor{comment}{/* Additional options. GNU argp shows args alphabetically */}}
\DoxyCodeLine{58     , \{\textcolor{stringliteral}{"{}rankTransitions"{}}, \textcolor{charliteral}{'T'}, 0, 0,}
\DoxyCodeLine{59         \textcolor{stringliteral}{"{}Rank transitions before expanding (default: false)"{}}\}}
\DoxyCodeLine{60     , \{\textcolor{stringliteral}{"{}maxIterations"{}}, \textcolor{charliteral}{'M'}, \textcolor{stringliteral}{"{}int"{}}, 0,}
\DoxyCodeLine{61         \textcolor{stringliteral}{"{}Maximum iteration for solution (default: 10000)"{}}\}}
\DoxyCodeLine{62     , \{\textcolor{stringliteral}{"{}maxStates"{}}, \textcolor{charliteral}{'V'}, \textcolor{stringliteral}{"{}integer"{}}, 0,}
\DoxyCodeLine{63         \textcolor{stringliteral}{"{}The maximum number of states to explore in an iteration (default 2000000)"{}}\}}
\DoxyCodeLine{64     , \{\textcolor{stringliteral}{"{}iterative"{}}, \textcolor{charliteral}{'I'}, 0, 0,}
\DoxyCodeLine{65         \textcolor{stringliteral}{"{}Use the STAMINA 2.5 method (iterative)"{}}\}}
\DoxyCodeLine{66     , \{\textcolor{stringliteral}{"{}priority"{}}, \textcolor{charliteral}{'P'}, 0, 0,}
\DoxyCodeLine{67         \textcolor{stringliteral}{"{}Use the STAMINA 3.0 method (priority)"{}}\}}
\DoxyCodeLine{68     , \{\textcolor{stringliteral}{"{}reExploring"{}}, \textcolor{charliteral}{'J'}, 0, 0,}
\DoxyCodeLine{69         \textcolor{stringliteral}{"{}Use the STAMINA 2.0 method (the method in STAMINA/PRISM)"{}}\}}
\DoxyCodeLine{70     , \{\textcolor{stringliteral}{"{}threads"{}}, \textcolor{charliteral}{'j'}, \textcolor{stringliteral}{"{}int"{}}, 0,}
\DoxyCodeLine{71         \textcolor{stringliteral}{"{}Number of threads to use for state exploration (default 1)"{}}\}}
\DoxyCodeLine{72     , \{ 0 \}}
\DoxyCodeLine{73 \};}
\DoxyCodeLine{74 }
\DoxyCodeLine{78 \textcolor{keyword}{struct }\mbox{\hyperlink{structarguments}{arguments}} \{}
\DoxyCodeLine{79     std::string model\_file;}
\DoxyCodeLine{80     std::string properties\_file;}
\DoxyCodeLine{81     \textcolor{keywordtype}{double} kappa;}
\DoxyCodeLine{82     \textcolor{keywordtype}{double} reduce\_kappa;}
\DoxyCodeLine{83     \textcolor{keywordtype}{double} approx\_factor; \textcolor{comment}{// Analagous to "{}misprediction factor"{} in the Java version}}
\DoxyCodeLine{84     \textcolor{keywordtype}{double} prob\_win;}
\DoxyCodeLine{85     uint64\_t max\_approx\_count;}
\DoxyCodeLine{86     \textcolor{keywordtype}{bool} no\_prop\_refine;}
\DoxyCodeLine{87     std::string cudd\_max\_mem;}
\DoxyCodeLine{88     std::string export\_filename;}
\DoxyCodeLine{89     std::string export\_perimeter\_states;}
\DoxyCodeLine{90     std::string import\_filename;}
\DoxyCodeLine{91     std::string property;}
\DoxyCodeLine{92     std::string consts;}
\DoxyCodeLine{93     std::string export\_trans;}
\DoxyCodeLine{94     \textcolor{keywordtype}{bool} rank\_transitions;}
\DoxyCodeLine{95     uint64\_t max\_iterations;}
\DoxyCodeLine{96     uint64\_t max\_states;}
\DoxyCodeLine{97     uint8\_t method;}
\DoxyCodeLine{98     uint8\_t threads;}
\DoxyCodeLine{99 \};}
\DoxyCodeLine{100 }
\DoxyCodeLine{104 \textcolor{keyword}{static} error\_t}
\DoxyCodeLine{105 parse\_opt(\textcolor{keywordtype}{int} key, \textcolor{keywordtype}{char} * arg, \textcolor{keyword}{struct} argp\_state * state) \{}
\DoxyCodeLine{106 }
\DoxyCodeLine{107     \textcolor{keyword}{struct }\mbox{\hyperlink{structarguments}{arguments}} * \mbox{\hyperlink{structarguments}{arguments}} = \textcolor{keyword}{static\_cast<}struct \mbox{\hyperlink{structarguments}{arguments}}*\textcolor{keyword}{>}(state-\/>input);}
\DoxyCodeLine{108     \textcolor{keywordflow}{switch} (key) \{}
\DoxyCodeLine{109         \textcolor{comment}{// kappa value}}
\DoxyCodeLine{110         \textcolor{keywordflow}{case} \textcolor{charliteral}{'k'}:}
\DoxyCodeLine{111             \mbox{\hyperlink{structarguments}{arguments}}-\/>kappa = (double) atof(arg);}
\DoxyCodeLine{112             \textcolor{keywordflow}{break};}
\DoxyCodeLine{113         \textcolor{comment}{// kappa reduction factor}}
\DoxyCodeLine{114         \textcolor{keywordflow}{case} \textcolor{charliteral}{'r'}:}
\DoxyCodeLine{115             \mbox{\hyperlink{structarguments}{arguments}}-\/>reduce\_kappa = (double) atof(arg);}
\DoxyCodeLine{116             \textcolor{keywordflow}{break};}
\DoxyCodeLine{117         \textcolor{comment}{// approx factor}}
\DoxyCodeLine{118         \textcolor{keywordflow}{case} \textcolor{charliteral}{'f'}:}
\DoxyCodeLine{119             \mbox{\hyperlink{structarguments}{arguments}}-\/>approx\_factor = (double) atof(arg);}
\DoxyCodeLine{120             \textcolor{keywordflow}{break};}
\DoxyCodeLine{121         \textcolor{comment}{// probability window (difference between Pmin and Pmax)}}
\DoxyCodeLine{122         \textcolor{keywordflow}{case} \textcolor{charliteral}{'w'}:}
\DoxyCodeLine{123             \mbox{\hyperlink{structarguments}{arguments}}-\/>prob\_win = (double) atof(arg);}
\DoxyCodeLine{124             \textcolor{keywordflow}{break};}
\DoxyCodeLine{125         \textcolor{comment}{// max number of iterations in approximation}}
\DoxyCodeLine{126         \textcolor{keywordflow}{case} \textcolor{charliteral}{'n'}:}
\DoxyCodeLine{127             \mbox{\hyperlink{structarguments}{arguments}}-\/>max\_approx\_count = (uint64\_t) atoi(arg);}
\DoxyCodeLine{128             \textcolor{keywordflow}{break};}
\DoxyCodeLine{129         \textcolor{comment}{// whether or not to use property based refinement}}
\DoxyCodeLine{130         \textcolor{keywordflow}{case} \textcolor{charliteral}{'R'}:}
\DoxyCodeLine{131             \mbox{\hyperlink{structarguments}{arguments}}-\/>no\_prop\_refine = \textcolor{keyword}{true};}
\DoxyCodeLine{132             \textcolor{keywordflow}{break};}
\DoxyCodeLine{133         \textcolor{comment}{// cudd max memory limit}}
\DoxyCodeLine{134         \textcolor{keywordflow}{case} \textcolor{charliteral}{'C'}:}
\DoxyCodeLine{135             \mbox{\hyperlink{structarguments}{arguments}}-\/>cudd\_max\_mem = std::string(arg);}
\DoxyCodeLine{136             \textcolor{keywordflow}{break};}
\DoxyCodeLine{137         \textcolor{comment}{// filename to export to}}
\DoxyCodeLine{138         \textcolor{keywordflow}{case} \textcolor{charliteral}{'e'}:}
\DoxyCodeLine{139             \mbox{\hyperlink{structarguments}{arguments}}-\/>export\_filename = std::string(arg);}
\DoxyCodeLine{140             \textcolor{keywordflow}{break};}
\DoxyCodeLine{141         \textcolor{comment}{// whether or not to export the perimeter states}}
\DoxyCodeLine{142         \textcolor{keywordflow}{case} \textcolor{charliteral}{'S'}:}
\DoxyCodeLine{143             \mbox{\hyperlink{structarguments}{arguments}}-\/>export\_perimeter\_states = \textcolor{keyword}{true};}
\DoxyCodeLine{144             \textcolor{keywordflow}{break};}
\DoxyCodeLine{145         \textcolor{comment}{// import model filename}}
\DoxyCodeLine{146         \textcolor{keywordflow}{case} \textcolor{charliteral}{'i'}:}
\DoxyCodeLine{147             \mbox{\hyperlink{structarguments}{arguments}}-\/>import\_filename = std::string(arg);}
\DoxyCodeLine{148             \textcolor{keywordflow}{break};}
\DoxyCodeLine{149         \textcolor{comment}{// specific property to check}}
\DoxyCodeLine{150         \textcolor{keywordflow}{case} \textcolor{charliteral}{'p'}:}
\DoxyCodeLine{151             \mbox{\hyperlink{structarguments}{arguments}}-\/>property = std::string(arg);}
\DoxyCodeLine{152             \textcolor{keywordflow}{break};}
\DoxyCodeLine{153         \textcolor{comment}{// constants to specify}}
\DoxyCodeLine{154         \textcolor{keywordflow}{case} \textcolor{charliteral}{'c'}:}
\DoxyCodeLine{155             \mbox{\hyperlink{structarguments}{arguments}}-\/>consts = std::string(arg);}
\DoxyCodeLine{156             \textcolor{keywordflow}{break};}
\DoxyCodeLine{157         \textcolor{comment}{// export transitions}}
\DoxyCodeLine{158         \textcolor{keywordflow}{case} \textcolor{charliteral}{'t'}:}
\DoxyCodeLine{159             \mbox{\hyperlink{structarguments}{arguments}}-\/>export\_trans = std::string(arg);}
\DoxyCodeLine{160             \textcolor{keywordflow}{break};}
\DoxyCodeLine{161         \textcolor{comment}{// use rank transitions before expanding}}
\DoxyCodeLine{162         \textcolor{keywordflow}{case} \textcolor{charliteral}{'T'}:}
\DoxyCodeLine{163             \mbox{\hyperlink{structarguments}{arguments}}-\/>rank\_transitions = \textcolor{keyword}{true};}
\DoxyCodeLine{164             \textcolor{keywordflow}{break};}
\DoxyCodeLine{165         \textcolor{comment}{// max number of iterations}}
\DoxyCodeLine{166         \textcolor{keywordflow}{case} \textcolor{charliteral}{'M'}:}
\DoxyCodeLine{167             \mbox{\hyperlink{structarguments}{arguments}}-\/>max\_iterations = (uint64\_t) atoi(arg);}
\DoxyCodeLine{168             \textcolor{keywordflow}{break};}
\DoxyCodeLine{169         \textcolor{keywordflow}{case} \textcolor{charliteral}{'V'}:}
\DoxyCodeLine{170             \mbox{\hyperlink{structarguments}{arguments}}-\/>max\_states = (uint64\_t) atoi(arg);}
\DoxyCodeLine{171             \textcolor{keywordflow}{break};}
\DoxyCodeLine{172         \textcolor{keywordflow}{case} \textcolor{charliteral}{'I'}:}
\DoxyCodeLine{173             \mbox{\hyperlink{structarguments}{arguments}}-\/>method = STAMINA\_METHODS::ITERATIVE\_METHOD;}
\DoxyCodeLine{174             \textcolor{keywordflow}{break};}
\DoxyCodeLine{175         \textcolor{keywordflow}{case} \textcolor{charliteral}{'P'}:}
\DoxyCodeLine{176             \mbox{\hyperlink{structarguments}{arguments}}-\/>method = STAMINA\_METHODS::PRIORITY\_METHOD;}
\DoxyCodeLine{177             \textcolor{keywordflow}{break};}
\DoxyCodeLine{178         \textcolor{keywordflow}{case} \textcolor{charliteral}{'J'}:}
\DoxyCodeLine{179             \mbox{\hyperlink{structarguments}{arguments}}-\/>method = STAMINA\_METHODS::RE\_EXPLORING\_METHOD;}
\DoxyCodeLine{180             \textcolor{keywordflow}{break};}
\DoxyCodeLine{181         \textcolor{comment}{// model and properties file}}
\DoxyCodeLine{182         \textcolor{keywordflow}{case} ARGP\_KEY\_ARG:}
\DoxyCodeLine{183             \textcolor{comment}{// get model file}}
\DoxyCodeLine{184             \textcolor{keywordflow}{if} (state-\/>arg\_num == 0) \{}
\DoxyCodeLine{185                 \mbox{\hyperlink{structarguments}{arguments}}-\/>model\_file = std::string(arg);}
\DoxyCodeLine{186             \}}
\DoxyCodeLine{187             \textcolor{comment}{// get properties file}}
\DoxyCodeLine{188             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (state-\/>arg\_num == 1) \{}
\DoxyCodeLine{189                 \mbox{\hyperlink{structarguments}{arguments}}-\/>properties\_file = std::string(arg);}
\DoxyCodeLine{190             \}}
\DoxyCodeLine{191             \textcolor{comment}{// we have too many arguments}}
\DoxyCodeLine{192             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{193                 argp\_usage(state);}
\DoxyCodeLine{194             \}}
\DoxyCodeLine{195             \textcolor{keywordflow}{break};}
\DoxyCodeLine{196         \textcolor{keywordflow}{case} ARGP\_KEY\_END:}
\DoxyCodeLine{197             \textcolor{keywordflow}{if} (state-\/>arg\_num < 2) \{}
\DoxyCodeLine{198                 \textcolor{comment}{/* Require at least 2 arguments */}}
\DoxyCodeLine{199                 argp\_usage(state);}
\DoxyCodeLine{200             \}}
\DoxyCodeLine{201             \textcolor{keywordflow}{break};}
\DoxyCodeLine{202         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{203             \textcolor{keywordflow}{return} ARGP\_ERR\_UNKNOWN;}
\DoxyCodeLine{204     \}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{207 \}}
\DoxyCodeLine{208 }
\DoxyCodeLine{212 \textcolor{keyword}{static} \textcolor{keyword}{struct }argp argp = \{options, parse\_opt, args\_doc, doc\};}
\DoxyCodeLine{213 }
\DoxyCodeLine{214 \textcolor{keywordtype}{void} set\_default\_values(\textcolor{keyword}{struct} \mbox{\hyperlink{structarguments}{arguments}} * \mbox{\hyperlink{structarguments}{arguments}});}
\DoxyCodeLine{215 }
\DoxyCodeLine{216 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STAMINA\_STAMINAARGPARSE\_H}}

\end{DoxyCode}
